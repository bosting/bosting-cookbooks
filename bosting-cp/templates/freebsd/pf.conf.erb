# Generated by Chef, do not edit

ext_if="<%= node['bosting-cp']['ext_if'] %>"
int_if="<%= node['bosting-cp']['int_if'] %>"

tcp_services="{ ssh domain http https ftp ftp-data pop3 smtp imap 49000:50000 <%= node['bosting-cp']['open_tcp_ports'] %> }"
udp_services="{ domain ntp <%= node['bosting-cp']['open_udp_ports'] %> }"
icmp_types="{ echoreq unreach }"

set skip on { lo0 lo1 $int_if }

scrub in all

nat on $ext_if from lo1:network to any -> ($ext_if)

table <ddos> persist
block quick on $ext_if from { <ddos> }

block in
pass out

antispoof quick for { lo0 lo1 $int_if }

pass in on $ext_if proto tcp to $ext_if port $tcp_services
pass in on $ext_if proto udp to $ext_if port $udp_services

pass in on $ext_if inet proto icmp from any to $ext_if icmp-type $icmp_types
